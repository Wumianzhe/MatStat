#+title: Лабораторная работа 2
#+LANGUAGE: ru
#+LATEX_CLASS: article
#+LATEX_CLASS_OPTIONS: [a4paper,fleqn,12pt]
#+options: toc:nil title:nil
#+property: header-args :noweb yes :eval no-export
#+property: header-args:julia :exports none
#+LATEX_HEADER: \usepackage[lmargin=15mm, rmargin=15mm, tmargin=2cm, bmargin=2cm]{geometry}
#+LATEX_HEADER: \usepackage{mathtools}
#+LATEX_HEADER: \DeclarePairedDelimiter{\lint}{(}{]}

\begin{titlepage}
  \Large
  \begin{center}
    Санкт-Петербургский\\
    Политехнический университет Петра Великого\\
    \vspace{10em}
    Математическая статистика\\
    \vspace{2em}
    \textbf{Отчёт по лабораторным работам 5-8}
  \end{center}
  \vspace{6em}
  \begin{flushright}
    Студент: Копнов Александр Александрович\\
    Преподаватель: Баженов Александр Николаевич\\
    Группа: 5030102/00101
  \end{flushright}
  \vspace{\fill}
  \begin{center}
    Санкт-Петербург\\
    2023
  \end{center}
\end{titlepage}
\tableofcontents
\listoffigures
\listoftables

* Постановка задачи
1. Сгенерировать двумерные выборки размерами 20, 60, 100 для нормального
   двумерного распределения \(N(x,y,0,0,1,1,\rho)\). Коэфициент корреляции \(\rho\)
   взять равным 0, 0.5, 0.9. Каждая выборка генерируется 1000 раз и для неё
   вычисляются: среднее значение, среднее значение квадрата и дисперсия
   коэффициентов корреляции Пирсона, Спирмена и квадрантного коэффициента
   корреляции. Повторить все вычисления для смеси нормальных распределений:
   \begin{equation}
   \label{eq:1}
   f(x,y) = 0.9N(x,y,0,0,1,1,0.9) + 0.1N(x,y,0,0,10,10,-0.9)
 \end{equation}
   Изобразить сгенерированные точки на плоскости и нарисовать эллипс равновероятности.
2. Найти отрезки коэффициентов линейной регрессии \(y_i=a + b x_i + e_i\)
   используя 20 точек на отрезке \([-1.8;2]\) с равномерным шагом равным 0.2.
   Ошибку \(e_i\) считать нормально распределённой с параметрами \((0,1)\). В
   качестве эталонной зависимости взять \(y_i = 2 + 2x_i + e_i\). При построении
   оценок коэффициентов использовать два критерия: критерий наименьших квадратов
   и критерий наименьших модулей. Проделать то же самое для выборки, у которой в
   значения \(y_1\) и \(y_{20}\) вносятся возмущения 10 и -10
3. Сгенерировать выборку объёмом 100 элементов для нормального распределения
   \(N(x,0,1)\). По сгенерированной выборке оценить параметры \(\mu\) и \(\sigma\)
   нормального закона методом максимального правдоподобия. В качестве
   основной гипотезы \(H_0\) будем считать, что сгенерированной
   распределение имеет вид \(N(x,\hat{\mu},\hat{\sigma})\). Проверить основную
   гипотезу, используя критерий согласия \(\chi^{2}\). В качестве уровня
   значимости взять \(\alpha = 0.05\). Привести таблицу вычислений \(\chi^2\).\\
   Исследовать точность (чувствительность) критерия \(\chi^2\) --- сгенерировать
   выборки равномерного распределения и распределения Лапласа малого объёма
   (например 20 элементов). Проверить их на нормальность.
4. Для двух выборок размерами 20 и 100 элементов, сгенерированных согласно
   нормальному закону \(N(x,0,1)\), для параметров положения и масштаба
   построить асимптотически нормальные интервальные оценки на основе
   точечных оценок метода максимального правдоподобия и классические
   интервальные оценки на основе статистик \(\chi^2\) и Стьюдента. В качестве
   параметра надёжности взять \(\gamma = 0.95\).

* Теория

** Двумерное нормальное распределение

Двумерная случайная величина \(X,Y\) называется распределённой нормально (или
просто нормальной), если её плотность вероятности определена формулой
\begin{equation}
\label{eq:2}
N(x,y,\overline{x},\overline{y},\sigma_{x},\sigma_{y},\rho) = \frac{1}{2\pi\sigma_{x}\sigma_{y}\sqrt{1 - \rho^2}} \times \exp \left\{ - \frac{1}{2(1-\rho^2)}
\left[ \frac{(x - \overline{x})^2}{\sigma_{x}^2} - 2\rho \frac{(x-\overline{x})(y-\overline{y})}{\sigma_{x}\sigma_{y}} +
\frac{(y-\overline{y})^2}{\sigma_{y}^2} \right] \right\}
\end{equation}

Компоненты \(X,Y\) двумерной нормальной с.в. также распределены нормально с
математическими ожиданиями \(\overline{x},\overline{y}\) и средними
квадратическими отклонениями \(\sigma_{x},\sigma_{y}\) соответственно [1, с. 133-134]. Параметр \rho называется
коэффициентом корреляции

** Корреляционный момент (ковариация) и коэффициент корреляции

Корееляционным моментом, иначе ковариацией, двух случайных величин \(X\) и \(Y\)
называется математическое ожидание произведения отклонений этих случайных
величин от их математических ожиданий [1, с. 141].
\begin{equation}
\label{eq:3}
K = cov(X,Y) = M[(X - \overline{x})(Y - \overline{y})]
\end{equation}

Коэффициентом корреляции \rho двух случайных величин \(X\) и \(Y\) называется
отношение их корреляционного момента к произведению их средних квадратических
отклонений:
\begin{equation}
\label{eq:4}
\rho = \frac{K}{\sigma_{x}\sigma_{y}}
\end{equation}

Коэффициент корреляции --- это нормированная числовая характеристика, являющаяся
мерой близости зависимости между случайными величинами к линейной [1, с. 150].
** Выборочные коэффициенты корреляции
*** Выборочный коэффициент корреляции Пирсона

Пусть по выборке значений \({x_i,y_i}_{1}^{n}\) двумерной с.в. \((X,Y)\) требуется
оценить коэффициент корреляции \(\rho = \frac{cov(X,Y)}{\sqrt{DX DY}}\).
Естественной оценкой для \rho служит его статистический аналог в виде выборочного
коэффициента корреляии, предложенного К.Пирсоном, ---
\begin{equation}
\label{eq:5}
r = \frac{\frac{1}{n}\sum (x_i - \overline{x})(y_i - \overline{y})}{\sqrt{\frac{1}{n} \sum (x_i - \overline{x})^2 \frac{1}{n} \sum (y_i - \overline{y})^2}} =
\frac{K}{s_{X}s_{Y}}
\end{equation}
где \(K,s_{X}^2,s_{Y}^2\) --- выборочные ковариация и дисперсии с.в. \(X\) и \(Y\) [1,
с. 535]
*** Выборочный квадрантный коэффициент корреляции

Кроме выборочного коэффициента корреляции Пирсона, существуют и другие оценки
степени взаимосвязи между случайными величинами. К ним относится выборочный
квадрантный коэффициент корреляии
\begin{equation}
\label{eq:6}
r_{Q} = \frac{(n_1 + n_3) - (n_2 + n_4)}{n}
\end{equation}

где \(n_1,n_2,n_3,n_4\) --- количества точек с координатами \(x_i,y_i\),
попавшими соответствено в I, I​I, I​I​I, I​V квадранты декартовой системы с осями \(x'
= x - med x, y' = y - med y\) и с центром в точке с координатами \((med x, med y)\)
*** Выборочный коэфффициент ранговой корреляции Спирмена

На практике нередко требуется оценить степень взаимодействия между
качественными признаками изучаемого объекта. Качественным называется признак,
который нельзя измерить точно, но который позволяет сравнивать изучаемые объекты
между собой и располагать их в порядке убывания или возрастания их качества. Для
этого объекты выстраиваются в определённом порядке в соответствии с
рассматриваемым признаком. Процесс упорядочения называется ранжированием, и
каждому члену упорядоченной последовательности объектов присваивается ранг, или
порядковый номер. Например, объекту  с наименьшим значением признака
присваивается ранг 1, следующему за ним объекту --- ранг 2, и т.д. Таким
образом, происходит сравнение каждого объекта со всеми объектами изучаемой
выборки.

Если объект обладает не одним, а двумя качественными признаками --- переменными
\(X\) и \(Y\), то для исследования их взаимосвязи используют выборочный
коэффициент корреляции между двумя последовательностями рангов этих признаков.
Обозначим ранги, соответствующие значениям переменной \(X\), через \(u\), а
ранги, соответствующие значениям переменной \(Y\) --- через \(v\).

Выборочный коэффициент ранговой корреляции Спирмена определяется как выборочный
коэффициент корреляции Пирсона между рангами \(u,v\) переменных \(X,Y\):
\begin{equation}
\label{eq:7}
r_{S} = \frac{\frac{1}{n}\sum (u_i - \overline{u})(v_i - \overline{v})}{\sqrt{\frac{1}{n} \sum (u_i - \overline{u})^2 \frac{1}{n} \sum (v_i - \overline{v})^2}},
\end{equation}
где \(\overline{u} = \overline{v} = \frac{1 + 2 + \ldots + n}{n} = \frac{n+1}{2}\)
--- среднее значение рангов [1, с. 540-541]
** Эллипсы рассеивания
Рассмотрим поверхность распределения, изображающую функцию \eqref{eq:1}. Она имеет вид
холма, вершина которого находится над точкой \((\overline{x},\overline{y})\).\\
В сечении поверхности распределения плоскостями, параллельными оси
\(N(x,y,\overline{x},\overline{y},\sigma_{x},\sigma_{y},\rho)\), получаются кривые, подобные
нормальным кривым распределения. В сечении поверхности распределения
плоскостями, параллельными плоскости \(xOy\):
\begin{equation}
\label{eq:8}
\frac{(x - \overline{x})^2}{\sigma_{x}^2} - 2\rho \frac{(x-\overline{x})(y-\overline{y})}{\sigma_{x}\sigma_{y}} + \frac{(y-\overline{y})^2}{\sigma_{y}^2} = const
\end{equation}

Уравнение эллипса \eqref{eq:8} можно проанализировать обычными методами аналитической
геометрии. Применяя их, убеждаемся, что центр эллипса 8 находится в точке с
координатами \((\overline{x},\overline{y})\); что касается направления осей
симметрии эллипса, они составляют с осью \(Ox\) углы, определяемые уравнением
\begin{equation}
\label{eq:9}
\tan(2\alpha) = \frac{2\rho\sigma_{x}\sigma_{y}}{\sigma_{x}^2 - \sigma_{y}^2}
\end{equation}
Это уравнение даёт два значения углов: \(\alpha\) и \(\alpha_{1}\), различающиеся на
\(\frac{\pi}{2}\).

Таким образом, ориентация эллипса \eqref{eq:8} относительно координатных осей
находится в прямой зависимости от коэффициента корреляции \(\rho\) системы
\((X,Y)\); если величины не коррелированны, то оси симметрии эллипса параллельны
координатным осям; в противном случае они составляют с координатными осями
некоторый угол.

Пересекая поверхность распределения плоскостями, параллельными плоскости
\(xOy\), и проектируя сечения на плоскость \(xOy\) мы получим целое семейство
подобных и одинаково расположенных эллипсов с общим центром
\((\overline{x},\overline{y})\). Во всех точках каждого из таких эллипсов
плотность распределения \(N(x,y,\overline{x},\overline{y},\sigma_{x},\sigma_{y},\rho)\) постоянна.
Поэтому такие эллипсы называются эллипсами равной плотности или эллипсами
рассеивания. Общие оси всех эллипсов рассеивания называются главными осями
рассеивания [2, с. 193-194]

** Простая линейная регрессия

*** Модель простой линейной регрессии

Регрессионную модель описания данных называют простой линейной регрессией, если
\begin{equation}
\label{eq:10}
y_i = \beta_{0} + \beta_{1}x_i + \epsilon_{i}, i = \overline{1,n}
\end{equation}
где \(x_1,\ldots,x_n\) --- заданные числа (значения фактора); \(y_1,\ldots,y_n\) ---
наблюдаемые значения отклика; \(\epsilon_{1},\ldots,\epsilon_{n}\) --- независимые, нормально
распределённые \(N(0,\sigma)\) с нулевым мат. ожиданием и одинаковой (неизвестной)
дисперсией случайные величины (ненаблюдаемые); \(\beta_{0},\beta_{1}\) --- неизвестные
параметры, подлежащие оцениванию

В модели \eqref{eq:10} отклик \(y\) зависит от одного фактора \(x\) и весь
разброс экспериментальных точек объясняется только погрешностями наблюдений
(результатов измерений) отклика \(y\). Погрешности результатов измерений \(x\) в
этой модели полагают существенно меньшими погрешностей результатов измерений
\(y\) , так что ими можно пренебречь [1, с.507].
*** Метод наименьших квадратов

При оценивании параметров регрессионной модели используют различные методы. Один
из наиболее распространённых подходов заключается в следующем: вводится мера
(критерий) рассогласования отклика и регрессионной функции, и оценки параметров
регрессии определяются так, чтобы сделать это рассогласование наименьшим.
Достаточно простые расчётные формулы для оценок получают при выборе критерия в
виде суммы квадратов отклонений значений отклика от значений регрессионной
функции (сумма квадратов остатков):
\begin{equation}
\label{eq:11}
Q(\beta_{0},\beta_{1}) = \sum_{i=1}^n \epsilon_{1}^{2} = \sum_{i=1}^n (y_i - \beta_{0} - \beta_{1}x_i)^2 \to \min_{\beta_{0},\beta_{1}}
\end{equation}

Задача минимизации квадратичного критерия \(Q(\beta_{0},\beta_{1})\) носит название задачи
метода наименьших квадратов (МНК), а оценки \(\hat{\beta_{0}},\hat{\beta_{1}}\) параметров
\(\beta_{0},\beta_{1}\), реализующие минимум критерия \(Q(\beta_{0},\beta_{1})\), называют МНК-оценками [1,
с. 508].
*** Расчётные формулы для МНК-оценок

МНК-оценки параметров \(\hat{\beta_{0}},\hat{\beta_{1}}\) находятся из условия обращения
функции \(Q(\beta_{0},\beta_{1})\) в минимум. Для нахождения МНК-оценок \(\hat{\beta_{0}},\hat{\beta_{1}}\)
выпишем необходимые условия экстремума
\begin{equation}
\label{eq:12}
\begin{cases}
  \pdv{Q}{\beta_{0}} = -2 \sum_{i=1}^n (y_i - \beta_{0} - \beta_{1}x_i) = 0\\
  \pdv{Q}{\beta_{1}} = -2 \sum_{i=1}^n (y_i - \beta_{0} - \beta_{1}x_i)x_i = 0
\end{cases}
\end{equation}

Далее для упрощения записи сумм будем опускать индекс суммирования. Из системы
\eqref{eq:12} получим:
\begin{equation}
\label{eq:13}
\begin{cases}
  n\hat{\beta_{0}} + \hat{\beta_{1}} \sum x_i = \sum y_i\\
  \hat{\beta_{0}}\sum x_i + \hat{\beta_{1}}\sum x_i^2 = \sum x_i y_i
\end{cases}
\end{equation}

Разделим оба уравнения на n:
\begin{equation}
\label{eq:14}
\begin{cases}
  \hat{\beta_{0}} + \hat{\beta_{1}} \frac{1}{n}\sum x_i = \frac{1}{n}\sum y_i\\
  \hat{\beta_{0}}\frac{1}{n}\sum x_i + \hat{\beta_{1}}\frac{1}{n}\sum x_i^2 = \frac{1}{n}\sum x_i y_i
\end{cases}
\end{equation}
и, используя известные статистические обозначения для выборочных первых и вторых
начальных моментов
\begin{equation}
\label{eq:15}
\overline{x} = \frac{1}{n}\sum x_i,\overline{y} = \frac{1}{n}\sum y_i, \overline{x^2} = \frac{1}{n}\sum x_i^2, \overline{xy} = \frac{1}{n}\sum x_i y_i
\end{equation}

получим
\begin{equation}
\label{eq:16}
\hat{\beta_{0}} + \hat{\beta_{1}}\overline{x} = \overline{y}\\
\hat{\beta_{0}}\overline{x} + \hat{\beta_{1}}\overline{x^2} = \overline{xy}
\end{equation}
откуда МНК-оценку \(\hat{\beta_{1}}\) наклона прямой регрессии находим по формуле
Крамера
\begin{equation}
\label{eq:17}
\hat{\beta_{1}} = \frac{\overline{xy} - \overline{x} \cdot \overline{y}}{\overline{x^2} - (\overline{x})^2}
\end{equation}
а МНК-оценку \(\hat{\beta_{0}}\) определяем непосредственно из первого уравнения
системы \eqref{eq:16}:
\begin{equation}
\label{eq:18}
\hat{\beta_{0}} = \overline{y} - \overline{x}\hat{\beta_{1}}
\end{equation}

Заметим, что определитель системы \eqref{eq:16}:
\begin{equation}
\label{eq:19}
\overline{x^2} - (\overline{x})^2 = \frac{1}{n} \sum (x_i - \overline{x})^2 = s_{x}^2 > 0
\end{equation}

если среди значений \(x_1,\ldots,x_n\) есть различные, что и будем предполагать.

Доказательство минимальности функции \(Q(\beta_{0},\beta_{1})\) в стационарной точке проведём
с помощью известного достаточного признака экстремума функции двух переменных.
Имеем:
\begin{equation}
\label{eq:20}
\pdv[2]{Q}{\beta_{0}} = 2n, \pdv[2]{Q}{\beta_{1}} = 2 \sum x_i^2 = 2n\overline{x^2}, \frac{\partial^2 Q}{\partial \beta_{1}\partial\beta_{0}} = 2 \sum x_i = 2n\overline{x}
\end{equation}
\begin{equation}
\label{eq:21}
\Delta = \pdv[2]{Q}{\beta_{0}}\cdot\pdv[2]{Q}{\beta_{1}} - \left( \frac{\partial^2 Q}{\partial \beta_{1}\partial\beta_{0}} \right) =
4n^2\overline{x^2} - 4n^2(\overline{x})^2 = 4n^2s_{x}^2 > 0
\end{equation}

Этот результат вместе с условием \(\pdv[2]{Q}{\beta_{0}^2} = 2n > 0\) означает, что в
стационарной точке функция \(Q\) имеет минимум [1,с. 508-511]

** Робастные оценки коэффициентов линейной регрессии

Робастность оценок коэффициентов линейной регрессии (т.е. их устойчивость по отношению к
наличию в данных редких, но больших по величине выбросов) может быть обеспечена различ-
ными способами. Одним из них является использование метода наименьших модулей вместо
метода наименьших квадратов:
\begin{equation}
\label{eq:22}
\sum_{i=1}^n \abs{ y_i - \beta_{0} - \beta_{1}x_i } \to \min _{\beta_{0},\beta_{1}}
\end{equation}

Напомним, что использование метода наименьших модулей в задаче оценивания параметра
сдвига распределений приводит к оценке в виде выборочной медианы, обладающей робастными
свойствами. В отличие от этого случая и от задач метода наименьших квадратов, на практике
задача \eqref{eq:22} решается численно. Соответствующие процедуры представлены в некоторых совре-
менных пакетах программ по статистическому анализу.
Здесь мы рассмотрим простейшую в вычистлительном отношении робастную альтернативу
оценкам коэффициентов линейной регрессии по МНК. Для этого сначала запишем выражения
для оценок \eqref{eq:18} и \eqref{eq:17} в другом виде:
\begin{equation}
\label{eq:23}
\begin{cases}
  \hat{\beta_{1}} =\frac{\overline{xy} - \overline{x}\cdot \overline{y}}{\overline{x^2} - (\overline{x})^2} =
  \frac{k_{xy}}{s_{x}^2} = \frac{k_{xy}}{s_{x}s_{y}} \cdot \frac{s_{y}}{s_{x}} = r_{xy} \frac{s_{y}}{s_{x}}\\
  \hat{\beta_{0}} = \overline{y} - \overline{x}\hat{\beta_{1}}
\end{cases}
\end{equation}
В формулах \eqref{eq:23} заменим выборочные средние \(\overline{x}\),
\(\overline{y}\) соответственно на робастные выборочные медианы \(med x\) и
\(med y\), среднеквадратические отклонения \(s_{x},s_{y}\) на робастные нормированные
интерквартильные широты \(q_{x}^{*},q_{y}^{*}\), выборочный коэффициент корреляции
\(r_{xy}\) на знаковый коэффициент корреляции \(r_{Q}\):
\begin{equation}
\label{eq:24}
\hat{\beta_{1}}_{R} = r_{Q} \frac{q_{y}^{*}}{q_{x}^{*}}
\end{equation}
\begin{equation}
\label{eq:25}
\hat{\beta_{0}}_{R} = med y - \hat{\beta_{1}}_{R} med x
\end{equation}
\begin{equation}
\label{eq:26}
r_{Q} = \frac{1}{n} \sum_{i=1}^n sgn(x_i - med x) sng(y_i - med y)
\end{equation}
\begin{equation}
\label{eq:27}
q_{y}^{*} = \frac{y_{(j)} - y_{(l)}}{k_{q}(n)}, \quad q_{x}^{*} = \frac{x_{(j)} - x_{(l)}}{k_{q}(n)},
\begin{cases}
  \left[ \frac{n}{4} + 1 \right] \text{ при } \frac{n}{4} \text{ дробном},\\
  \frac{n}{4} \text{ при } \frac{n}{4} \text{ целом}
\end{cases}
j = n - l + 1
\end{equation}

Уравнение регрессии здесь имеет вид
\begin{equation}
\label{eq:28}
y = \hat{\beta_{0}}_{R} + \hat{\beta_{1}}_{R}x
\end{equation}

Статистики выборочной медианы и интерквартильной широты обладают робастными
свойствами в силу того, что основаны на центральных порядковых статистиках,
малочувствительных к большим по величине выбросам в данных. Статистика
выборочного знакового коэффициента робастна, так как знаковая функция \(sgn z\)
чувствительна не к величине аргумента, а только к его знаку. Отсюда оценка
прямой регрессии обладает очевидными робастными свойствами устойчивости к
выбросам по координате \(y\), но она довольно груба [1, с. 518-519].
** Метод максимального правдоподобия
Одним из универсальных методов оценивания является метод максимального
правдоподобия, предложенный Р.Фишером (1921). Пусть \(x_1,\ldots,x_n\) --- случайная
выборка из генеральной совокупности с плотностью вероятности \(f(x,\theta);
L(x_1,\ldots,x_n,\theta)\) --- функция правдоподобия (ФП), представляющая собой совместную
плотность вероятности независимых с.в. \(x_1,\ldots,x_n\) и рассматриваемая как
функция неизвестного параметра \(\theta\):
\begin{equation}
\label{eq:29}
L(x_1,\ldots,x_n,\theta) = f(x_1,\theta)f(x_2,\theta)\ldots f(x_n,\theta)
\end{equation}

*Определение* Оценкой максимального правдоподобия (о.м.п.) будем называть такое значение
\(\hat{\theta}\) из множества допустимых значений параметра \theta, для которого ФП
принимает наибольшее значение при заданных \(x_1,\ldots,x_n\):
\begin{equation}
\label{eq:30}
\hat{\theta} = \arg \max_{\theta} L(x_1,\ldots,x_n,\theta)
\end{equation}
Если ФП дважды дифференцируема, то её стационарные значения даются корнями
уравнения
\begin{equation}
\label{eq:31}
\pdv{L(x_1),\ldots,x_n,\theta}{\theta} = 0
\end{equation}

Достаточным условием того, чтобы некоторое стационарное значение \(\tilde{\theta}\) было
локальным максимумом является неравенство
\begin{equation}
\label{eq:32}
\pdv[2]{L}{\theta}(x_1,\ldots,x_n,\tilde{\theta}) < 0
\end{equation}

Определив точки локальных максимумов ФП (если их несколько), находят наибольший,
который и даёт решение задачи \eqref{eq:29}. Часто проще искать максимум
логарифма ФП, так как он имеет максимум в одной точке с ФП:
\begin{equation}
\label{eq:33}
\pdv{\ln L}{\theta} = \frac{1}{L}\pdv{L}{\theta}, L > 0
\end{equation}
и соответственно решать уравнение
\begin{equation}
\label{eq:34}
\pdv{\ln L}{\theta} = 0
\end{equation}
которое называют /уравнением правдоподобия/. В задаче оценивания векторного
параметра \(\theta = (\theta_{1},\ldots,\theta_{m})\) аналогично \eqref{eq:30} находится максимум ФП
нескольких аргументов:
\begin{equation}
\label{eq:35}
\hat{\theta} = \arg \max_{\theta_{1},\ldots,\Theta_{m}} L(x_1,\ldots,x_n,\theta_{1},\ldots,\theta_{n})
\end{equation}
и в случае дифференцируемости ФП выписывается система уравнений правдоподобия
\begin{equation}
\label{eq:36}
\pdv{L}{\theta_{k}} = 0 \text{ или } \pdv{\ln L}{\theta_{k}} = 0, k = \overline{1,m}
\end{equation}
** Проверка гипотезы о законе распределения генеральной совокупности. Метод хи-квадрат

Исчерпывающей характеристикой изучаемой случайной величины является её закон
распределения. Поэтому естественно стремление исследователей построить этот
закон приближённо на основе статистических данных.

Сначала выдвигается гипотеза о виде закона распределения

После того как выбран вид закона,, возникает задача оценивания его параметров и
проверки (тестирования) закона в целом.

Для проверки гипотезы о законе распределения применяются критерии согласия.
Таких критериев существует много. Мы рассмотрим наиболее обоснованный и наиболее
часто использумый на практике --- критерий \(\chi^2\), введённый К.Пирсоном (1900
г.) для случая, когда параметры распределения известны. Этот критерий был
существенно уточнён Р. Фишером (1924 г.), когда параметры распределения
оцениваются по выборке, используемой для проверки.

Мы ограничимся рассмотрением случая одномерного распределения.

Итак, выдвинута гипотеза \(H_{0}\) о генерально законе распределения с функцией
распределения \(F(x)\)

Рассматриваем случай, когда гипотетическая функция распределения \(F(x)\) не
содержит неизвестных параметров.

Разобьём генеральную совокупность, т.е. множество значений изучаемой случайной
величины \(X\) на \(k\) непересекающихся подмножеств \(\Delta_{1},\ldots,\Delta_{k}\).

Пусть \(p_i = P(X \in \Delta_{i}), i = \overline{1,k}\).

Если генеральная совокупность --- вся вещественная ось, то подмножества \(\Delta_{i} =
\lint{a_{i-1},a_{i}}\) --- полуоткрытые промежутки (\(i = \overline{2,k-1}\)). Крайние
промежутки будут полубесконечными: \(\Delta_{1} = \lint{-\infty,a_1},\Delta_{k} = \lint(a_{k-1},+\infty)\). В
этом случае \(p_i = F(a_i) - F(a_{i-1}); a_0 = -\infty, a_k = + \infty (i=\overline{1,k})\)

Отметим, что \(\sum_{i=1}^k p_i = 1\). Будем предполагать, что все \(p_i > 0,
i=\overline{1,k}\).

Пусть, далее, \(n_1,\ldots,n_k\) --- частоты попадания выборочных элементов в
подмножества \(\Delta_{1},\ldots,\Delta_{k}\) соответственно.

В случае справедливости гипотезы \(H_0\) относительные частоты \(n_i / n\) при
большом \(n\) должны быть близки к вероятностям \(p_i\), поэтому за меру
отклонения выборочного распределения от гипотетического с функцией \(F(x)\)
естественно выбрать величину
\begin{equation}
\label{eq:37}
Z = \sum_{i=1}^k c_i \left( \frac{n_i}{n} - p_i \right)^2
\end{equation}
где \(c_i\) --- веса. К.Пирсоном в качестве весов выбраны числа \(c_i =
\frac{n}{p_i}\). Тогда получается статистика критерия хи-квадрат К.Пирсона
\begin{equation}
\label{eq:38}
\chi^2 = \sum_{i=1}^k \frac{n}{p_i} \left( \frac{n_i}{n} - p_i \right)^2 = \sum_{i=1}^k \frac{(n_i - n p_i)^2}{n p_i}
\end{equation}
которая обозначена тем же символом, что и закон распределения хи-квадрат.

К.Пирсоном доказана теорема об асимптотическом поведении статистики \(\chi^2\),
указывающая путь её применения\\
*Теорема К.Пирсона*. Статистика критерия \(\chi^2\) асимптотически распределена по
закону \(\chi^2\) с \(k-1\) степенями свободы.

Это означает, что независимо от вида проверяемого распределения, т.е. функции
\(F(x)\), выборочная функция распределения статистики \(\chi^2\)при \(n \to \infty\)
стремится к функции распределения случайной величины с плотностью вероятности
\begin{equation}
\label{eq:39}
f_{k-1}(x) =
\begin{cases}
  0, x \leq 0\\
  \frac{1}{2^{\frac{k-1}{2}}\Gamma(\frac{k-1}{2})} x^{\frac{k-3}{2}}e^{-\frac{x}{2}}, x > 0
\end{cases}
\end{equation}
Для прояснения сущности метода \(\chi^2\) сделаем ряд замечаний.

*Замечание 1*. Выбор подмножеств \(\Delta_{1},\ldots,\Delta_{k}\) и  их числа k в принципе ничем не
 регламентируется, так как \(n \to \infty\). Но так как число \(n\) хотя и очень
 большое, но конечное, то \(k\) должно быть с ним согласовано. Обычно его берут
 таким же, как и для построения гистограммы, т.е. можно руководствоваться
 формулой
 \begin{equation}
 \label{eq:40}
 k \approx 1.72\sqrt[3]{n}
 \end{equation}
 или формулой Старджесса
 \begin{equation}
 \label{eq:41}
 k \approx 1 + 3.3 \lg n
 \end{equation}
 При этом, если \(\Delta_{1},\ldots,\Delta_{n}\) --- промежутки, то их длины удобно сделать равными,
 за исключением крайних --- полубесконечных.

 *Замечание 2* (о числе степеней свободы). Числом степеней свободы функции (по
  старой терминологии) называется число её независимых аргументов. Аргументами
  статистики \(\chi^2\) являются частоты \(n_1,\ldots,n_k\). Эти частоты связаны одним
  равенством \(n_1 + n_2 + \dots + n_k = n\), а в остальном независимы в силу
  независимости элементов выборки. Таким образом, функция \(\chi^2\) имеет \(k-1\)
  независимых аргументов: число частот минус одна связь. В силу теоремы Пирсона
  число степеней свободы статистики \(\chi^2\) отражается на виде асимптотической
  плотности \(f_{k-1}(x)\)

  На основе общей схемы проверки статистических гипотез сформулируем следующее
  правило.\\
  *Правило проверки гипотезы о законе распределения по методу \(\chi^2\)*
  1. Выбираем уровень значимости \(\alpha\).
  2. По таблице [3, с. 358] находим квантиль \(\chi_{1-\alpha}^2(k-1)\) распределения
     хи-квадрат с \(k-1\) степенью свободы порядка \(1 - \alpha\)
  3. С помощью гипотетической функции распределения \(F(x)\) вычисляем
     вероятности \(p_i = P(X \in\Delta_{i}), i = \overline{1,k}\)
  4. Находим частоты \(n_i\) попадания элементов выборки в подмножества \(\Delta_{i},i = \overline{i,k}\).
  5. Вычисляем выборочное значение статистики критерия \(\chi^2\):
            \begin{equation}
     \label{eq:42}
     \chi_{B}^2 = \sum_{i=1}^k \frac{(n_i) - n p_i)^2}{n p_i}
     \end{equation}
  6. Сравниваем \(\chi^2_{B}\) и квантиль \(\chi_{1-\alpha}^2(k-1)\).
     a. Если \(\chi^2_{B} < \chi^2_{1-\alpha}(k-1)\), то гипотеза \(H_0\) на данном этапе
        проверки принимается.
     b. Если \(\chi^2_{B} \geq \chi^2_{1-\alpha}\), то гипотеза \(H_0\) отвергается, выбирается одно
        из альтернативных распределений, и процедура проверки повторяется

*Замечание 3*. Из формулы \eqref{eq:38} видим, что веса \(c_i = n / p_i\)
 пропорциональны \(n\), т.е. с ростом \(n\) увеличиваются. Отсюда следует, что
 если выдвинутая гипотеза неверна, то относительные частоты \(n_i / n\) не будут
 близки к вероятностям \(p_i\), и с ростом n величина \(\chi^2_{B}\) будет
 увеличивать- ся. При фиксированном уровне значимости \(\alpha\) будет фиксировано
 пороговое число - квантиль \(\chi^2_{1-\alpha}(k -1)\), поэтому, увеличивая \(n\), мы
 придём к неравенству \(\chi^2_{B} > \chi^2_{1-\alpha}(k-1)\), т.е. с увеличением объёма выборки
 неверная гипотеза будет отвергнута.

 *Замечание 4*. Теория и практика применения критерия \(\chi^2\) указывают, что если
  для каких-либо подмножеств \(\Delta_{i}(i=\overline{1,k})\) условие \(n p_i \geq 5\) не
  выполняется, то следует объединить соседние подмножества (промежутки)

  Это условие выдвигается требованием близости величин \(\frac{n_i - n
  p_i}{\sqrt{n p_i}}\), квадраты которых являются слагаемыми \(\chi^2\) к
  нормальным \(N(0,1)\). Тогда случайная величина в формуле \eqref{eq:38} будет
  распределена по закону, близкому к хи-квадрат. Такая близость обеспечивается
  достаточной численностью элементов в подмножествах \(\Delta_{i}\) [1, с. 481-485]


** Доверительные интервалы для параметров нормального распределения

*** Доверительный интервал для математического ожидания \mu нормального распределения

Дана выборка \((x_1, \dots ,x_n)\) объёма n из нормальной генеральной совокупности.
На её основе строим выборочное среднее \(\overline{x}\) и выборочное среднее
квадратическое отклонение \(s\). Параметры \mu и \sigma нормального распределения
неизвестны.

Доказано, что случайная величина
\begin{equation}
\label{eq:43}
T = \sqrt{n-1} \frac{\overline{x} - \mu}{s}
\end{equation}
называемая /статистикой Стьюдента/, распределена по закону Стьюдента с \(n-1\)
степенями свободы. Пусть \(f_{T}(x)\) --- плотность вероятности этого
распределения. Тогда
\begin{equation}
\label{eq:44}
\begin{split}
P \left( -x < \sqrt{n - 1} \frac{\overline{x} - \mu}{s} < x \right) = P \left( -x < \sqrt{n-1} \frac{\mu - \overline{x}}{s} < x \right) =\\
\int_{-x}^x f_{T}(t) dt = 2 \int_0^x f_{T}(t) dt = 2 \left( \int_{-\infty}^x f_{T}(t)dt - \frac{1}{2}\right) = 2F_{T}(x) - 1
\end{split}
\end{equation}

Здесь \(F_{T}(x)\) --- /функция распределения Стьюдента с n - 1 степенями свободы/.

Полагаем \(2F_{T}(x) - 1 = 1 - \alpha\), где \(\alpha\) --- выбранный уровень значимости.
Тогда \(F_{T}(x) = 1 - \alpha / 2\). Пусть \(t_{1-\alpha / 2}(n-1)\) --- квантиль распределения
Стьюдента с \(n - 1\) степенями свободы и порядка \(1 - \alpha / 2\). Из предыдущих
равенств мы получаем
\begin{equation}
\label{eq:45}
\begin{split}
  P \left( \overline{x} - \frac{sx}{\sqrt{n - 1}} < \mu < \overline{x} + \frac{sx}{\sqrt{n-1}} \right) = 2F_{T}(x) - 1 = 1 - \alpha\\
  P \left( \overline{x} - \frac{st_{1-\alpha / 2}(n-1)}{\sqrt{n - 1}} < \mu < \overline{x} + \frac{st_{1-\alpha / 2}(n-1)}{\sqrt{n-1}} \right) = 2F_{T}(x) - 1 = 1 - \alpha\\
\end{split}
\end{equation}
что и даёт доверительный интервал для \(m\) с доверительной вероятностью \(\gamma =
1 - \alpha\) [1, с. 457-458]
*** Доверительный интервал для среднего квадратического отклонения \sigma нормального распределения

Дана выборка \((x_1, \dots, x_n)\) объёма n из нормальной генеральной совокупности.
На её основе строим выборочную дисперсию \(s^2\). Параметры \mu и \sigma  нормального
распределения неизвестны. Доказано, что случайная величина \(n s^2 / \sigma^2\)
распределена по закону \(\chi^2\) с \(n-1\) степенями свободы. Задаёмся уровнем
значимости \(\alpha\) и находим квантили \(\chi^2_{\alpha / 2}(n-1),\chi^2_{1 - \alpha / 2}(n-1)\).\\
Это значит, что
\begin{equation}
\label{eq:46}
\begin{split}
  P(\chi^2(n-1) < \chi^2_{\alpha / 2}(n-1)) = \alpha / 2 \\
  P(\chi^2(n-1) < \chi^2_{1 - \alpha / 2}(n-1)) = 1 - \alpha / 2
\end{split}
\end{equation}
Тогда
\begin{equation}
\label{eq:47}
P(\chi^2_{\alpha / 2}(n-1) < \chi^2(n-1) < \chi^2_{1 - \alpha / 2}(n-1)) = 1 - \alpha
\end{equation}
Отсюда
\begin{equation}
\label{eq:48}
\begin{split}
  P \left(\chi^2_{\alpha / 2}(n-1) < \frac{ns^2}{\sigma^2}<\chi^2_{1-\alpha / 2}(n-1) \right) = P\left(\frac{1}{\chi^2_{1-\alpha / 2}(n-1)}
  < \frac{\sigma^2}{ns^2}<\frac{1}{\chi^2_{\alpha / 2}(n-1)} \right) =\\ P \left(\frac{s\sqrt{n}}{\sqrt{\chi^2_{1 - \alpha / 2}(n-1)}}
  < \sigma<\frac{s\sqrt{n}}{\sqrt{\chi^2_{\alpha / 2}(n-1)}} \right) = 1 - \alpha
\end{split}
\end{equation}
Окончательно
\begin{equation}
\label{eq:49}
P \left(\frac{s\sqrt{n}}{\sqrt{\chi^2_{\alpha / 2}(n-1)}}  < \sigma<\frac{s\sqrt{n}}{\sqrt{\chi^2_{1-\alpha / 2}(n-1)}} \right) = 1 - \alpha
\end{equation}
что и даёт доверительный интервал для \sigma с доверительной вероятностью \(\gamma = 1 - \alpha\)
** Доверительные интервалы для математического ожидания \mu и среднего квадратического отклонения \sigma произвольного распределения при большом объёме выборки. Асимптотический подход
*** Доверительный интервал для математического ожидания \mu произвольной генеральной совокупности при большом объёме выборки
Выборочное среднее \(\overline{x} = \frac{1}{n}\sum_{i=1}^n x_i\) при большом объёме
выборки является суммой большого числа взаимно независимых одинаково
распределённых случайных величин. Предполагаем, что исследуемое генеральное
распределение имеет конечные математическое ожидание \mu и дисперсию \(\sigma^2\).
Тогда в силу центральной предельной теоремы центрированная и нормированная
случайная величина \(\frac{\overline{x} - M\overline{x}}{\sqrt{D \overline{x}}}
= \sqrt{ \overline{x} - \mu } / \sigma\) распределена приблизительно нормально с
параметрами 0 и 1. Пусть
\begin{equation}
\label{eq:50}
\Phi(x) = \frac{1}{2\pi} \int_{-\infty}^x e^{-\frac{t^2}{2}}dt
\end{equation}
--- /функция Лапласа/. Тогда
\begin{equation}
\label{eq:51}
\begin{split}
  P \left( -x < \sqrt{n} \frac{\overline{x} - \mu}{\sigma} < x \right) = P \left( -x < \sqrt{n} \frac{\mu - \overline{x}}{\sigma} < x \right)\approx\\
  \Phi(x) - \Phi(-x) = \Phi(x) - [1 - \Phi(x)] = 2\Phi(x) - 1
\end{split}
\end{equation}
Отсюда
\begin{equation}
\label{eq:52}
P \left( \overline{x} - \frac{\sigma x}{\sqrt{n}} < \mu < \overline{x} - \frac{\sigma x}{\sqrt{n}} \right) \approx 2\Phi(x) - 1
\end{equation}
Полагаем \(2\Phi(x) - 1 = \gamma = 1 - \alpha\). тогда \(\Phi(x) = 1 - \alpha / 2\). Пусть \(u_{1 - \alpha /
2}\) --- квантиль нормального распределения \(N(0,1)\) порядка \(1 - \alpha / 2\).
Заменяя в \eqref{eq:52} \sigma на s, запишем его в виде
\begin{equation}
\label{eq:53}
P \left( \overline{x} - \frac{su_{1-\alpha /2}}{\sqrt{n}} < \mu < \overline{x} - \frac{su_{1-\alpha / 2}}{\sqrt{n}} \right) \approx \gamma
\end{equation}
что и даёт доверительный интервал для \(m\) с доверительной вероятностью \(\gamma =
1 - \alpha\)[1,с. 460]
*** Доверительный интервал для среднего квадратического отклонения \sigma произвольной генеральной совокупности при большом объёме выборки
Выборочная дисперсия \(s^2 = \sum_{i=1}^n \frac{(x_i - \overline{x})^2}{n}\) при
большом объёме выборки является суммой большого числа практически взаимно
независимых случайных величин. Предполагаем, что исследуемая генеральная
совокупность имеет конечные первые 4 момента.
В силу центральной предельной теоремы центрированная и нормированная случайная
величина \(\frac{s^2 - M s^2}{\sqrt{D s^2}}\) при большом объёме выборки n
распределена приблизительно нормально с параметрами 0 и 1. Пусть \(\Phi(x)\) ---
функци Лапласа \eqref{eq:50}. Тогда
\begin{equation}
\label{eq:54}
P \left( -x < \frac{s^2 - M s^2}{\sqrt{D s^2}} < x \right)\approx 2\Phi(x) - 1
\end{equation}
Положим \(2\Phi(x) - 1 = \gamma = 1 -\alpha\). тогда \(\Phi(x) = 1 - \alpha / 2\). Пусть \(u_{1-\alpha / 2}\)
--- квантиль нормлаьного распределения \(N(0,1)\) порядка \(1 - \alpha / 2\).
Известно, что \(Ms^2 = \sigma^2 - \frac{\sigma^2}{n} \approx \sigma^2\) и \(Ds^2 = \frac{\mu_{4} -
\mu_{2}^2}{n} + o(\frac{1}{n}) \approx \frac{\mu_{4} - \mu^2_{2}}{n}\). Здесь \(\mu_{k}\) --- центральный
момент k-го порядка генерального распределения; \(\mu_{2} = \sigma^2; \mu_{4} = M[(x - M
x)^{4}]\), \(o(\frac{1}{n})\) --- бесконечно малая высшего порядка, чем \(1 / n\),
при \(n \to \infty\). Итак, \(D s^2 \approx \frac{\mu_{4} - \mu^2_{2}}{n}\). Отсюда
\begin{equation}
\label{eq:55}
Ds^2 \approx \frac{\sigma^{4}}{n} (\frac{\mu_{4}}{\sigma^{4}} - 1) = \frac{\sigma^{4}}{n} \left( (\frac{\mu_{4}}{\sigma^{4}} - 3) + 2 \right) = \frac{\sigma^{4}}{n}(E + 2) \approx \frac{\sigma^{4}}{n}(e+2)
\end{equation}
где \(E = \frac{\mu_{4}}{\sigma^{4}} - 3\) --- эксцесс генерального распределения, \(e =
\frac{m_{4}}{s^{4}} - 3\) --- выборочный эксцесс; \(m_{4} = \frac{1}{n}\sum_{i=1}^n (x_i -
\overline{x})^{4}\) --- четвёртый выборочный центральный момент. Далее,
\begin{equation}
\label{eq:56}
\sqrt{Ds^2} \approx \frac{\sigma^2}{\sqrt{n}}\sqrt{e + 2}
\end{equation}
Преобразуем неравенства, стоящие под знаком вероятности в формуле \eqref{eq:54}:
\begin{equation}
\label{eq:57}
\begin{split}
  -\sigma^2 U < s^2 - \sigma^2 < \sigma^2 U\\
  \sigma^2(1-U) < s^2 < \sigma^2(1+U)\\
  1 / [\sigma^2(1+U)] < \frac{1}{s^2} < 1 / [\sigma^2(1 - U)]\\
  s^2 / (1 + U) < \sigma^2 < s^2 / (1 - U)\\
  s(1 + U)^{-1 / 2} < \sigma < s(1 - U)^{-1 /2}
\end{split}
\end{equation}
где \(U = u_{1-\alpha / 2}\sqrt{(e + 2) / n}\).

Разлагая функции в биноминальный ряд и оставляя первые два члена, получим
\begin{equation}
\label{eq:58}
s(1 - 0.5U) < \sigma < s(1+0.5U)
\end{equation}
Формулы \eqref{eq:57} и \eqref{eq:58} дают доверительный интервал для \sigma с
доверительной вероятностью \(\gamma = 1 - \alpha\)[1, с. 461-462].

/Замечание/ Вычисления по формуле \eqref{eq:57} дают более надёжный результат, так
как в ней меньше грубых приближений.
* Реализация
Лабораторная работа выполнена с помощью языка программирования ~Julia~. Исходный
код работы находится в репозитории [[github:Wumianzhe/MatStat/tree/Lab2][github]]

* Результаты
** Выборочные коэффициенты корреляции

#+name: csv_to_org
#+begin_src emacs-lisp :exports none :eval never-export
(defun csv-to-table (file)
  (with-temp-buffer
    (erase-buffer)
    (insert-file file)
    (org-table-convert-region (point-min) (point-max) '(4))
    (buffer-string)))
#+end_src

#+name: charTable20
#+caption: Двумерное нормальное распределение, n=20
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/char20.csv")
#+end_src

#+RESULTS: charTable20
#+caption: Двумерное нормальное распределение, n=20
| \rho=0.0    |       |        |       |
|          |   $r$ |  $r_S$ | $r_Q$ |
| E(z)     | 0.008 |  0.004 | 0.008 |
| $E(z^2)$ | 0.050 |  0.018 | 0.051 |
| D(z)     | 0.225 |  0.136 | 0.227 |
|          |       |        |       |
| \rho=0.5    |       |        |       |
|          |   $r$ |  $r_S$ | $r_Q$ |
| E(z)     | 0.477 |  0.007 | 0.449 |
| $E(z^2)$ | 0.261 |  0.019 | 0.238 |
| D(z)     | 0.184 |  0.137 | 0.192 |
|          |       |        |       |
| \rho=0.9    |       |        |       |
|          |   $r$ |  $r_S$ | $r_Q$ |
| E(z)     | 0.894 | -0.007 | 0.865 |
| $E(z^2)$ | 0.802 |  0.018 | 0.753 |
| D(z)     | 0.054 |  0.133 | 0.071 |
|          |       |        |       |

#+name: charTable60
#+caption: Двумерное нормальное распределение, n=60
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/char60.csv")
#+end_src

#+RESULTS: charTable60
#+caption: Двумерное нормальное распределение, n=60
| \rho=0.0    |        |        |        |
|          |    $r$ |  $r_S$ |  $r_Q$ |
| E(z)     | -0.001 |  0.003 | -0.003 |
| $E(z^2)$ |  0.017 |  0.006 |  0.018 |
| D(z)     |  0.132 |  0.078 |  0.134 |
|          |        |        |        |
| \rho=0.5    |        |        |        |
|          |    $r$ |  $r_S$ |  $r_Q$ |
| E(z)     |  0.496 |  0.004 |  0.475 |
| $E(z^2)$ |  0.256 |  0.006 |  0.237 |
| D(z)     |  0.099 |  0.077 |  0.105 |
|          |        |        |        |
| \rho=0.9    |        |        |        |
|          |    $r$ |  $r_S$ |  $r_Q$ |
| E(z)     |  0.900 | -0.002 |  0.885 |
| $E(z^2)$ |  0.811 |  0.006 |  0.784 |
| D(z)     |  0.027 |  0.077 |  0.033 |
|          |        |        |        |

#+name: charTable100
#+caption: Двумерное нормальное распределение, n=100
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/char100.csv")
#+end_src

#+RESULTS: charTable100
#+caption: Двумерное нормальное распределение, n=100
| \rho=0.0    |       |       |       |
|          |   $r$ | $r_S$ | $r_Q$ |
| E(z)     | 0.002 | 0.003 | 0.003 |
| $E(z^2)$ | 0.010 | 0.004 | 0.010 |
| D(z)     | 0.101 | 0.061 | 0.100 |
|          |       |       |       |
| \rho=0.5    |       |       |       |
|          |   $r$ | $r_S$ | $r_Q$ |
| E(z)     | 0.501 | 0.001 | 0.482 |
| $E(z^2)$ | 0.256 | 0.004 | 0.239 |
| D(z)     | 0.074 | 0.063 | 0.078 |
|          |       |       |       |
| \rho=0.9    |       |       |       |
|          |   $r$ | $r_S$ | $r_Q$ |
| E(z)     | 0.898 | 0.001 | 0.884 |
| $E(z^2)$ | 0.807 | 0.003 | 0.783 |
| D(z)     | 0.019 | 0.059 | 0.025 |
|          |       |       |       |

#+name: charTableMix
#+caption: Смесь двумерных нормальных распределений
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/charMix.csv")
#+end_src

#+RESULTS: charTableMix
#+caption: Смесь двумерных нормальных распределений
| size=20   |       |        |       |
|           |   $r$ |  $r_S$ | $r_Q$ |
| E(z)      | 0.692 | -0.002 | 0.652 |
| $E(z^2)$  | 0.495 |  0.017 | 0.447 |
| D(z)      | 0.127 |  0.132 | 0.147 |
|           |       |        |       |
| size=60   |       |        |       |
|           |   $r$ |  $r_S$ | $r_Q$ |
| E(z)      | 0.702 |  0.003 | 0.678 |
| $E(z^2)$  | 0.496 |  0.006 | 0.465 |
| D(z)      | 0.065 |  0.078 | 0.074 |
|           |       |        |       |
| size=100  |       |        |       |
|           |   $r$ |  $r_S$ | $r_Q$ |
| E(z)      | 0.701 |  0.000 | 0.680 |
| $E(z^2)$  | 0.494 |  0.004 | 0.465 |
| D(z)      | 0.051 |  0.060 | 0.059 |
|           |       |        |       |

\pagebreak
** Эллипсы рассеивания
#+caption: Двумерное нормальное распределение, n=20
[[./figs/ell20.png]]

#+caption: Двумерное нормальное распределение, n=60
[[./figs/ell60.png]]

#+caption: Двумерное нормальное распределение, n=100
[[./figs/ell100.png]]

#+caption: Смесь двумерных нормальных распределений
[[./figs/ellMix.png]]
\pagebreak
** Оценки коэффициентов линейной регрессии

Метрика удалённости \(dist = \sum_{i=1}^n (y[i] - y_{regr}[i])\)
*** Выборка без возмущений

1. Критерий наименьших квадратов: \(\hat{\beta_{0}} = 2.184,\hat{\beta_{1}} = 2.062, dist = 23.51755\)
2. Критерий наименьших модулей: \(\hat{\beta_{0}} = 2.593,\hat{\beta_{1}} = 1.613, dist = 31.56825\)

#+caption: Выборка без возмущений
[[./figs/linBase.png]]

*** Выборка с возмущениями

1. Критерий наименьших квадратов: \(\hat{\beta_{0}} = 2.326,\hat{\beta_{1}} = 0.634, dist = 185.65634\)
2. Критерий наименьших модулей: \(\hat{\beta_{0}} = 2.593,\hat{\beta_{1}} = 1.583, dist = 212.21999\)

#+caption: Выборка с возмущениями
[[./figs/linMangled.png]]

|     | \(\hat{a}\) | \(\hat{a}'\) | \(\hat{b}\) | \(\hat{b}'\) | \(\frac{\hat{a} - \hat{a}'}{\hat{a}}\) | \(\frac{\hat{b} - \hat{b}'}{\hat{b}}\) |
| МНК |       2.184 |        2.326 |       2.062 |        0.634 |                                  0.065 |                                  0.692 |
| МНМ |       2.593 |        2.593 |       1.613 |        1.583 |                                      0 |                                  0.018 |

** Проверка гипотезы о законе распределения генеральной совокупности. Метод хи-квадрат

Исследуем \(N(0,1)\), размер выборки 100:

Метод максимального правдоподобия: \[
  \hat{\mu} = -0.03\quad \hat{\sigma} = 0.973
\]

#+name: chiNormal
#+caption: 100 значений из нормального распределения
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/chiNormal.csv")
#+end_src

#+RESULTS: chiNormal
#+caption: 100 значений из нормального распределения
|   i | $\Delta_i$         |   $n_i$ | $p_i$ |  $np_i$ | $n_i - np_i$ | $\frac{(n_i - np_i)^2}{np_i}$ |
|   1 | (-Inf,-2.57]  |   1.000 | 0.005 |   0.452 |        0.548 |                         0.665 |
|   2 | (-2.57,-1.59] |   5.000 | 0.049 |   4.946 |        0.054 |                         0.001 |
|   3 | (-1.59,-0.62] |  19.000 | 0.219 |  21.884 |       -2.884 |                         0.380 |
|   4 | (-0.62,0.36]  |  41.000 | 0.382 |  38.217 |        2.783 |                         0.203 |
|   5 | (0.36,1.33]   |  25.000 | 0.265 |  26.454 |       -1.454 |                         0.080 |
|   6 | (1.33,2.31]   |   9.000 | 0.072 |   7.238 |        1.762 |                         0.429 |
|   7 | (2.31,Inf]    |   0.000 | 0.008 |   0.808 |       -0.808 |                         0.808 |
| $\sum$ | -             | 100.000 | 1.000 | 100.000 |       -0.000 |                         2.565 |

Видно, что \(\chi^2_{B} < \chi^2_{0.95} \approx 14.67\), следовательно полагаем гипотезу о том,
что это распределение \(N(\hat{\mu},\hat{\sigma})\) верной.

Исследуем \(L(0,\frac{1}{\sqrt{2}})\), размер выборки 20:

Метод максимального правдоподобия: \[
  \hat{\mu} = 0.06\quad \hat{\sigma} = 0.581
\]
#+name: chiLaplace
#+caption: 20 значений из распределения Лапласа
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/chiLaplace.csv")
#+end_src

#+RESULTS: chiLaplace
#+caption: 20 значений из распределения Лапласа
|   i | $\Delta_i$        |  $n_i$ | $p_i$ | $np_i$ | $n_i - np_i$ | $\frac{(n_i - np_i)^2}{np_i}$ |
|   1 | (-Inf,-0.83] |  1.000 | 0.063 |  1.268 |       -0.268 |                         0.057 |
|   2 | (-0.83,0.44] | 16.000 | 0.679 | 13.589 |        2.411 |                         0.428 |
|   3 | (0.44,1.7]   |  3.000 | 0.255 |  5.096 |       -2.096 |                         0.862 |
|   4 | (1.7,Inf]    |  0.000 | 0.002 |  0.046 |       -0.046 |                         0.046 |
| $\sum$ | -            | 20.000 | 1.000 | 20.000 |        0.000 |                         1.393 |

Видно, что \(\chi^2_{B} < \chi^2_{0.95} \approx 9.48\), следовательно полагаем гипотезу  о том,
что это распределение \(N(\hat{\mu},\hat{\sigma})\) верной.

Исследуем \(U(-\sqrt{3},\sqrt{3})\), размер выборки 20:

Метод максимального правдоподобия: \[
  \hat{\mu} = -0.11\quad \hat{\sigma} = 0.894
\]
#+name: chiUniform
#+caption: 20 значений из равномерного распределения
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/chiUniform.csv")
#+end_src

#+RESULTS: chiUniform
#+caption: 20 значений из равномерного распределения
|   i | $\Delta_i$       |  $n_i$ | $p_i$ | $np_i$ | $n_i - np_i$ | $\frac{(n_i - np_i)^2}{np_i}$ |
|   1 | (-Inf,-1.6] |  1.000 | 0.043 |  0.850 |        0.150 |                         0.026 |
|   2 | (-1.6,0.05] |  7.000 | 0.427 |  8.538 |       -1.538 |                         0.277 |
|   3 | (0.05,1.7]  | 12.000 | 0.472 |  9.444 |        2.556 |                         0.692 |
|   4 | (1.7,Inf]   |  0.000 | 0.058 |  1.167 |       -1.167 |                         1.167 |
| $\sum$ | -           | 20.000 | 1.000 | 20.000 |        0.000 |                         2.162 |

Видно, что \(\chi^2_{B} < \chi^2_{0.95} \approx 9.48\), следовательно полагаем гипотезу  о том,
что это распределение \(N(\hat{\mu},\hat{\sigma})\) верной.

** Доверительные интервалы для параметров нормального распределения
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/interNorm.csv")
#+end_src

#+caption: Доверительные интервалы для параметров нормального распределения
#+RESULTS:
| size=20  | $\mu$                  | $\sigma$                 | $\mu = [internal \subseteq external]$       |
|          | -0.157 < $\mu$ < 0.538 | 0.565 < $\sigma$ < 1.085 | [-0.157,0.538] $\subseteq$ [-1.242,1.623] |
| size=100 | $\mu$                  | $\sigma$                 | $\mu = [internal \subseteq external]$       |
|          | -0.278 < $\mu$ < 0.083 | 0.799 < $\sigma$ < 1.057 | [-0.278,0.083] $\subseteq$ [-1.335,1.139] |


** Доверительне интервалы для параметров произвольного распределения. Асимптотический подход
#+begin_src emacs-lisp :exports results :results raw :noweb yes :eval no-export
<<csv_to_org>>
(csv-to-table "./figs/interAsimp.csv")
#+end_src

#+caption: Доверительные интервалы для параметров произвольного распределения. Асимптотический подход
#+RESULTS:
| size=20  | $\mu$                  | $\sigma$                 | $\mu = [internal \subseteq external]$       |
|          | -0.127 < $\mu$ < 0.508 | 0.539 < $\sigma$ < 1.646 | [-0.127,0.508] $\subseteq$ [-1.773,2.154] |
| size=100 | $\mu$                  | $\sigma$                 | $\mu = [internal \subseteq external]$       |
|          | -0.275 < $\mu$ < 0.08  | 0.799 < $\sigma$ < 1.068 | [-0.275,0.08] $\subseteq$ [-1.343,1.147]  |

* Обсуждение
** Выборочные коэффициенты корреляции

Для двумерного нормального распределения порядок дисперсий выборочных коэффициентов
корреляции зависит от значения коэфициента: при \(\rho = 0,0.5: r_{S} < r_{Q} \approx r\), при
\(\rho = 0.9: r < r_{Q} < r_{S}\). Для смеси распределений наблюдаем \(r < r_{Q} < r_{S}\)

Процент попавших элементов выборки в эллипс рассеивания (95%-ная доверительная
область) примерно равен его теоретическому значению (95%).
** Оценки коэффициентов линейной регрессии

По полученным результатам можно сказать, что критерий наименьших квадратов
точнее оценивает коэффициенты линейной регрессии на выборке без возмущений. Если
же присутствуют выбросы, лучше использовать критерий наименьших модулей, так как
он более устойчив.
** Проверка гипотезы о законе распределения генеральной совокупности. Метод хи-квадрат

Гипотеза \(H_0\) о нормальном законе распределения \(N(x,\hat{\mu},\hat{\sigma})\) на
уровне значимости \(\alpha = 0.05\) согласуется с выборкой для нормального
распределения \(N(x,0,1)\).

Также видно, что для выборок с 20 элементами, сгенерированных по равномерному закону и закону
Лапласа гипотеза о нормальном законе распределения также оказалась принята.
** Доверительные интервалы для параметров распределения

+ Генеральные характеристики (\mu =0, \sigma = 1) накрываются построенными доверительными интервалами.
+ Для большей выборки доверительные интервалы меньше по длине, т.е. оценка более точная.
+ При большом объёме выборки классические и асимптотические оценки практически совпадают
